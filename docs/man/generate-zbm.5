.\" Automatically generated by Pod::Man 4.14 (Pod::Simple 3.42)
.\"
.\" Standard preamble:
.\" ========================================================================
.de Sp \" Vertical space (when we can't use .PP)
.if t .sp .5v
.if n .sp
..
.de Vb \" Begin verbatim text
.ft CW
.nf
.ne \\$1
..
.de Ve \" End verbatim text
.ft R
.fi
..
.\" Set up some character translations and predefined strings.  \*(-- will
.\" give an unbreakable dash, \*(PI will give pi, \*(L" will give a left
.\" double quote, and \*(R" will give a right double quote.  \*(C+ will
.\" give a nicer C++.  Capital omega is used to do unbreakable dashes and
.\" therefore won't be available.  \*(C` and \*(C' expand to `' in nroff,
.\" nothing in troff, for use with C<>.
.tr \(*W-
.ds C+ C\v'-.1v'\h'-1p'\s-2+\h'-1p'+\s0\v'.1v'\h'-1p'
.ie n \{\
.    ds -- \(*W-
.    ds PI pi
.    if (\n(.H=4u)&(1m=24u) .ds -- \(*W\h'-12u'\(*W\h'-12u'-\" diablo 10 pitch
.    if (\n(.H=4u)&(1m=20u) .ds -- \(*W\h'-12u'\(*W\h'-8u'-\"  diablo 12 pitch
.    ds L" ""
.    ds R" ""
.    ds C` ""
.    ds C' ""
'br\}
.el\{\
.    ds -- \|\(em\|
.    ds PI \(*p
.    ds L" ``
.    ds R" ''
.    ds C`
.    ds C'
'br\}
.\"
.\" Escape single quotes in literal strings from groff's Unicode transform.
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\"
.\" If the F register is >0, we'll generate index entries on stderr for
.\" titles (.TH), headers (.SH), subsections (.SS), items (.Ip), and index
.\" entries marked with X<> in POD.  Of course, you'll have to process the
.\" output yourself in some meaningful fashion.
.\"
.\" Avoid warning from groff about undefined register 'F'.
.de IX
..
.nr rF 0
.if \n(.g .if rF .nr rF 1
.if (\n(rF:(\n(.g==0)) \{\
.    if \nF \{\
.        de IX
.        tm Index:\\$1\t\\n%\t"\\$2"
..
.        if !\nF==2 \{\
.            nr % 0
.            nr F 2
.        \}
.    \}
.\}
.rr rF
.\"
.\" Accent mark definitions (@(#)ms.acc 1.5 88/02/08 SMI; from UCB 4.2).
.\" Fear.  Run.  Save yourself.  No user-serviceable parts.
.    \" fudge factors for nroff and troff
.if n \{\
.    ds #H 0
.    ds #V .8m
.    ds #F .3m
.    ds #[ \f1
.    ds #] \fP
.\}
.if t \{\
.    ds #H ((1u-(\\\\n(.fu%2u))*.13m)
.    ds #V .6m
.    ds #F 0
.    ds #[ \&
.    ds #] \&
.\}
.    \" simple accents for nroff and troff
.if n \{\
.    ds ' \&
.    ds ` \&
.    ds ^ \&
.    ds , \&
.    ds ~ ~
.    ds /
.\}
.if t \{\
.    ds ' \\k:\h'-(\\n(.wu*8/10-\*(#H)'\'\h"|\\n:u"
.    ds ` \\k:\h'-(\\n(.wu*8/10-\*(#H)'\`\h'|\\n:u'
.    ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'^\h'|\\n:u'
.    ds , \\k:\h'-(\\n(.wu*8/10)',\h'|\\n:u'
.    ds ~ \\k:\h'-(\\n(.wu-\*(#H-.1m)'~\h'|\\n:u'
.    ds / \\k:\h'-(\\n(.wu*8/10-\*(#H)'\z\(sl\h'|\\n:u'
.\}
.    \" troff and (daisy-wheel) nroff accents
.ds : \\k:\h'-(\\n(.wu*8/10-\*(#H+.1m+\*(#F)'\v'-\*(#V'\z.\h'.2m+\*(#F'.\h'|\\n:u'\v'\*(#V'
.ds 8 \h'\*(#H'\(*b\h'-\*(#H'
.ds o \\k:\h'-(\\n(.wu+\w'\(de'u-\*(#H)/2u'\v'-.3n'\*(#[\z\(de\v'.3n'\h'|\\n:u'\*(#]
.ds d- \h'\*(#H'\(pd\h'-\w'~'u'\v'-.25m'\f2\(hy\fP\v'.25m'\h'-\*(#H'
.ds D- D\\k:\h'-\w'D'u'\v'-.11m'\z\(hy\v'.11m'\h'|\\n:u'
.ds th \*(#[\v'.3m'\s+1I\s-1\v'-.3m'\h'-(\w'I'u*2/3)'\s-1o\s+1\*(#]
.ds Th \*(#[\s+2I\s-2\h'-\w'I'u*3/5'\v'-.3m'o\v'.3m'\*(#]
.ds ae a\h'-(\w'a'u*4/10)'e
.ds Ae A\h'-(\w'A'u*4/10)'E
.    \" corrections for vroff
.if v .ds ~ \\k:\h'-(\\n(.wu*9/10-\*(#H)'\s-2\u~\d\s+2\h'|\\n:u'
.if v .ds ^ \\k:\h'-(\\n(.wu*10/11-\*(#H)'\v'-.4m'^\v'.4m'\h'|\\n:u'
.    \" for low resolution devices (crt and lpr)
.if \n(.H>23 .if \n(.V>19 \
\{\
.    ds : e
.    ds 8 ss
.    ds o a
.    ds d- d\h'-1'\(ga
.    ds D- D\h'-1'\(hy
.    ds th \o'bp'
.    ds Th \o'LP'
.    ds ae ae
.    ds Ae AE
.\}
.rm #[ #] #H #V #F C
.\" ========================================================================
.\"
.IX Title "generate-zbm 5"
.TH generate-zbm 5 "2022-02-19" "1.12.0" "config.yaml"
.\" For nroff, turn off justification.  Always turn off hyphenation; it makes
.\" way too many mistakes in technical documents.
.if n .ad l
.nh
.SH "NAME"
config.yaml \- configuration file for generate\-zbm
.SH "SYNOPSIS"
.IX Header "SYNOPSIS"
\&\fB/etc/zfsbootmenu/config.yaml\fR
.SH "DESCRIPTION"
.IX Header "DESCRIPTION"
The \s-1YAML\s0 file \fI/etc/zfsbootmenu/config.yaml\fR controls the generation of ZFSBootMenu images by \fBgenerate-zbm\fR(8).
.SH "SECTIONS"
.IX Header "SECTIONS"
The configuration is divided into several logical sections as keys of a \s-1YAML\s0 map. The value of each section is itself a \s-1YAML\s0 map.
.SS "Global"
.IX Subsection "Global"
.IP "\fBManageImages\fR" 4
.IX Item "ManageImages"
This must be set to \fItrue\fR before \fBgenerate-zbm\fR will attempt to perform any action (e.g., image creation or pruning old files).
.IP "\fBInitCPIO\fR" 4
.IX Item "InitCPIO"
Set to \fItrue\fR to use \fBmkinitcpio\fR instead of \fBdracut\fR to create ZFSBootMenu images.
.IP "\fBDracutConfDir\fR" 4
.IX Item "DracutConfDir"
The path of the dracut configuration directory for ZFSBootMenu. This \fB\s-1MUST NOT\s0\fR be the same location as the system \fIdracut.conf.d\fR, as the configuration files there interfere with the creation of the ZFSBootMenu initramfs. If unspecified, a default value of \fI/etc/zfsbootmenu/dracut.conf.d\fR is assumed. This value is ignored when \fIGlobal.InitCPIO\fR is \fItrue\fR.
.IP "\fBInitCPIOConfig\fR" 4
.IX Item "InitCPIOConfig"
The path to a mkinitcpio configuration file for ZFSBootMenu. The \fIzfsbootmenu\fR hook will be forcefully added when \fBgenerate-zbm\fR invokes \fBmkinitcpio\fR using a command-line argument and does not need to be specified in the \fI\s-1HOOKS\s0\fR array in the configuration file. This value is ignored when \fIGlobal.InitCPIO\fR is not \fItrue\fR.
.IP "\fBInitCPIOHookDirs\fR" 4
.IX Item "InitCPIOHookDirs"
A single path or an array of paths to \fBmkinitcpio\fR hook directories. When specifying a custom directory for the \fIzfsbootmenu\fR hook, it is generally required to also specify the default location as well. This option is ignored when \fIGlobal.InitCPIO\fR is not \fItrue\fR.
.IP "\fBBootMountPoint\fR" 4
.IX Item "BootMountPoint"
In general, this should be the location of your \s-1EFI\s0 System Partition. \fBgenerate-zbm\fR will ensure that this is mounted when images are created and, if \fBgenerate-zbm\fR does the mounting, will unmount this filesystem on exit. When this parameter is not specified, \fBgenerate-zbm\fR will not verify or attempt to mount any filesystems.
.IP "\fBVersion\fR" 4
.IX Item "Version"
A specific ZFSBootMenu version string to use in producing images. In the string, the value \fI%{current}\fR will be replaced with the release version of ZFSBootMenu. The default value is simply \fI%{current}\fR.
.IP "\fBDracutFlags\fR" 4
.IX Item "DracutFlags"
An array of additional arguments that will be passed to \fBdracut\fR when generating an initramfs. This option is ignored when \fIGlobal.InitCPIO\fR is \fItrue\fR.
.IP "\fBInitCPIOFlags\fR" 4
.IX Item "InitCPIOFlags"
An array of additional arguments that will be passed to \fBmkinitcpio\fR when generating an initramfs. This option is ignored when \fIGlobal.InitCPIO\fR is not \fItrue\fR.
.IP "\fBPreHooksDir\fR" 4
.IX Item "PreHooksDir"
The path of the directory containing executables that should be executed after \fIBootMountPoint\fR has been mounted. Files in this directory should be \fB+x\fR, and are executed in the order returned by a shell glob. The exit code of each hook is ignored.
.IP "\fBPostHooksDir\fR" 4
.IX Item "PostHooksDir"
The path of the directory containing executables that should be executed after all images have been created and any file pruning has taken place. Files in this directory should be \fB+x\fR, and are executed in the order returned by a shell glob. The exit code of each hook is ignored.
.SS "Kernel"
.IX Subsection "Kernel"
.IP "\fBCommandLine\fR" 4
.IX Item "CommandLine"
If you're making a unified \s-1EFI\s0 file or a syslinux configuration, this is the command line passed to the boot image.
.IP "\fBPath\fR" 4
.IX Item "Path"
The full path to a specific kernel to use when making the boot images. If not specified, \fBgenerate-zbm\fR will try to pick a reasonable kernel.
.IP "\fBVersion\fR" 4
.IX Item "Version"
A specific kernel version to use. The value \fI%{current}\fR will be replaced with the output of \fBuname \-r\fR. If not set, \fBgenerate-zbm\fR will try to parse the path of the selected kernel filename for a version.
.IP "\fBPrefix\fR" 4
.IX Item "Prefix"
The prefix to use for the names of ZFSBootMenu images. By default, the prefix is extracted from the input kernel name.
.SS "Components"
.IX Subsection "Components"
.IP "\fBEnabled\fR" 4
.IX Item "Enabled"
When \fItrue\fR, \fBgenerate-zbm\fR will create separate ZFSBootMenu kernel and initramfs images. The default value is \fIfalse\fR.
.IP "\fBImageDir\fR" 4
.IX Item "ImageDir"
The destination directory for separate initramfs and kernel images.
.IP "\fBVersions\fR" 4
.IX Item "Versions"
When \fIfalse\fR or \fI0\fR, image versioning will be disabled; \fBgenerate-zbm\fR will not use its \fIGlobal.Version\fR parameter to name outputs, and will keep exactly one backup copy of any image it would overwrite.
.Sp
When \fItrue\fR (which behaves as \fI1\fR) or any positive integer, \fBgenerate-zbm\fR will append the value of \fIGlobal.Version\fR to every image it produces, followed by a revision as \fI_$revision\fR. \fBgenerate-zbm\fR will save \fIComponents.Versions\fR revisions of all images with versions matching the current value of \fIGlobal.Version\fR. In addition, \fBgenerate-zbm\fR will save the highest revision of the most recent \fIComponents.Versions\fR image versions distinct from \fIGlobal.Version\fR.
.SS "Components.syslinux"
.IX Subsection "Components.syslinux"
.IP "\fBEnabled\fR" 4
.IX Item "Enabled"
When \fItrue\fR, syslinux configuration generation is enabled. The default value is \fIfalse\fR.
.IP "\fBConfig\fR" 4
.IX Item "Config"
The path of the syslinux configuration file to produce.
.SS "\s-1EFI\s0"
.IX Subsection "EFI"
.IP "\fBEnabled\fR" 4
.IX Item "Enabled"
When \fItrue\fR, \fBgenerate-zbm\fR will create unified \s-1UEFI\s0 bundles. The default value is \fIfalse\fR.
.IP "\fBImageDir\fR" 4
.IX Item "ImageDir"
The destination directory for unified \s-1EFI\s0 files.
.IP "\fBVersions\fR" 4
.IX Item "Versions"
Behaves similarly to \fIComponents.Versions\fR, but acts on files matching the \s-1UEFI\s0 bundle naming scheme.
.IP "\fBStub\fR" 4
.IX Item "Stub"
The path to the \s-1EFI\s0 stub loader used to boot the unified bundle. If not set, a default of \fI/usr/lib/gummiboot/linuxx64.efi.stub\fR is assumed.
.SH "EXAMPLE"
.IX Header "EXAMPLE"
The following example will write separate, unversioned ZFSBootMenu kernel and initramfs images to \fI/boot/efi/EFI/void\fR, keeping a backup for each file that would be overwritten when creating the new images. In addition, a versioned \s-1UEFI\s0 bundle will be stored in the same directory, where two prior revisions of the current version and the highest revision of each of the two most recent prior versions will be retained.
.Sp
.Vb 10
\&  Global:
\&    ManageImages: true
\&    BootMountPoint: /boot/efi
\&    DracutConfDir: /etc/zfsbootmenu/dracut.conf.d
\&  Components:
\&    ImageDir: /boot/efi/EFI/void
\&    Versions: false
\&    Enabled: true
\&    syslinux:
\&      Config: /boot/syslinux/syslinux.cfg
\&      Enabled: false
\&  EFI:
\&    ImageDir: /boot/efi/EFI/void
\&    Versions: 2
\&    Enabled: true
\&  Kernel:
\&    CommandLine: ro quiet loglevel=0
.Ve
.SH "SEE ALSO"
.IX Header "SEE ALSO"
\&\fBgenerate-zbm\fR(8) \fBzfsbootmenu\fR(7)
.SH "AUTHOR"
.IX Header "AUTHOR"
ZFSBootMenu Team <https://github.com/zbm\-dev/zfsbootmenu>
